<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Salsa Demo Programs: /home/jenkins/workspace/SalsaDemos/Ancho/ZoneSenseDoppler/main.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Salsa Demo Programs
   &#160;<span id="projectnumber">2016-05-03</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_43e0a1f539e00dcfa1a6bc4d4fee4fc2.html">home</a></li><li class="navelem"><a class="el" href="dir_337c3a93990b7dbc7695d613ed19043e.html">jenkins</a></li><li class="navelem"><a class="el" href="dir_66e3ff4cadd89b6e62cafb2105835506.html">workspace</a></li><li class="navelem"><a class="el" href="dir_7afc540aa59c01078fb11ff79218d290.html">SalsaDemos</a></li><li class="navelem"><a class="el" href="dir_c47e70f5dc48ff09c30dc9b1fb25cb6d.html">Ancho</a></li><li class="navelem"><a class="el" href="dir_c9c2c9d77968b10a2f14ad401a5b8c04.html">ZoneSenseDoppler</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">main.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;getopt.h&gt;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &quot;anchoHelper.h&quot;</code><br />
<code>#include &quot;radarHelper.h&quot;</code><br />
<code>#include &quot;radarDSP.h&quot;</code><br />
<code>#include &quot;doppler.h&quot;</code><br />
<code>#include &quot;cluttermap.h&quot;</code><br />
<code>#include &quot;Radarlib3.h&quot;</code><br />
<code>#include &quot;<a class="el" href="utility_8h_source.html">../../Common/inc/utility.h</a>&quot;</code><br />
</div>
<p><a href="_ancho_2_zone_sense_doppler_2main_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:aed8c37fd6aaacee448c1660f09f11ed5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_ancho_2_zone_sense_doppler_2main_8c.html#aed8c37fd6aaacee448c1660f09f11ed5">SHOW_DEBUG_SETTINGS</a></td></tr>
<tr class="separator:aed8c37fd6aaacee448c1660f09f11ed5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d72754a58dc9658cc48d79f95b2021a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_ancho_2_zone_sense_doppler_2main_8c.html#a7d72754a58dc9658cc48d79f95b2021a">DOPPLER_LENGTH</a>&#160;&#160;&#160;(16)</td></tr>
<tr class="separator:a7d72754a58dc9658cc48d79f95b2021a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad48ea9b06da6b3c5d9a4c4a5eedf32b3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_ancho_2_zone_sense_doppler_2main_8c.html#ad48ea9b06da6b3c5d9a4c4a5eedf32b3">DOPPLER_PLOT_STEPS</a>&#160;&#160;&#160;(4)</td></tr>
<tr class="separator:ad48ea9b06da6b3c5d9a4c4a5eedf32b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04cd99408e5aa73da70ee01ca940c860"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_ancho_2_zone_sense_doppler_2main_8c.html#a04cd99408e5aa73da70ee01ca940c860">DOPPLER_VELOCITY_COUNTS</a>&#160;&#160;&#160;(4)</td></tr>
<tr class="separator:a04cd99408e5aa73da70ee01ca940c860"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a5ae07f63d6b390e42068d941038dadf2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_ancho_2_zone_sense_doppler_2main_8c.html#a5ae07f63d6b390e42068d941038dadf2">Usage</a> ()</td></tr>
<tr class="separator:a5ae07f63d6b390e42068d941038dadf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e58dce613fe188fd11fa271fea5c7ac"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_ancho_2_zone_sense_doppler_2main_8c.html#a3e58dce613fe188fd11fa271fea5c7ac">DopplerRotate</a> (double *dopplerMatrix, double *dopplerReordered, int rowLen, int colLen)</td></tr>
<tr class="separator:a3e58dce613fe188fd11fa271fea5c7ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9b526a5bd6a28fbf68db96e8ac72a51"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_ancho_2_zone_sense_doppler_2main_8c.html#ae9b526a5bd6a28fbf68db96e8ac72a51">UpdateVelocity</a> (int *velocities, int value, int len)</td></tr>
<tr class="separator:ae9b526a5bd6a28fbf68db96e8ac72a51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0335d78a0133db828d47d868ea8e5a93"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_ancho_2_zone_sense_doppler_2main_8c.html#a0335d78a0133db828d47d868ea8e5a93">InterpretZone</a> (double distance, int *velocities, int len, int dopplerLen)</td></tr>
<tr class="separator:a0335d78a0133db828d47d868ea8e5a93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_ancho_2_zone_sense_doppler_2main_8c.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (int argc, char **argv)</td></tr>
<tr class="separator:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a7d72754a58dc9658cc48d79f95b2021a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d72754a58dc9658cc48d79f95b2021a">&#9670;&nbsp;</a></span>DOPPLER_LENGTH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DOPPLER_LENGTH&#160;&#160;&#160;(16)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_ancho_2_zone_sense_doppler_2main_8c_source.html#l00101">101</a> of file <a class="el" href="_ancho_2_zone_sense_doppler_2main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="ad48ea9b06da6b3c5d9a4c4a5eedf32b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad48ea9b06da6b3c5d9a4c4a5eedf32b3">&#9670;&nbsp;</a></span>DOPPLER_PLOT_STEPS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DOPPLER_PLOT_STEPS&#160;&#160;&#160;(4)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_ancho_2_zone_sense_doppler_2main_8c_source.html#l00104">104</a> of file <a class="el" href="_ancho_2_zone_sense_doppler_2main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="a04cd99408e5aa73da70ee01ca940c860"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04cd99408e5aa73da70ee01ca940c860">&#9670;&nbsp;</a></span>DOPPLER_VELOCITY_COUNTS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DOPPLER_VELOCITY_COUNTS&#160;&#160;&#160;(4)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_ancho_2_zone_sense_doppler_2main_8c_source.html#l00107">107</a> of file <a class="el" href="_ancho_2_zone_sense_doppler_2main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="aed8c37fd6aaacee448c1660f09f11ed5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed8c37fd6aaacee448c1660f09f11ed5">&#9670;&nbsp;</a></span>SHOW_DEBUG_SETTINGS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SHOW_DEBUG_SETTINGS</td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="anchor" id="bbb_ancho_zonesense_doppler_demo"></a> </p><h1>ZoneSenseDoppler</h1>
<p>ZoneSenseDoppler builds on the <em>DopplerDemo</em> project by adding in some additional interpretation of the data.</p>
<h2>Hardware Setup</h2>
<p>For this demo, a BeagleBone Black + an Ancho cape + Sinuous antenna cape is positioned on a desk with the antennas facing the ceiling.</p>
<h2>Demonstration Code</h2>
<p>ZoneSenseDoppler adds in a very simple target detection. The Doppler matrix max value is compared to a threshold, and depending on the result, a different message is displayed to the user.</p>
<p>For the demonstration, the area above the radar is divided into three zones where each zone ranges from one distance to another.</p>
<p>As the application runs, the terminal is used to give the user feedback. For the demonstration, a target such as a human hand or a small metal plate is moved up and down over the radar. The distance to the target is shown. Also, depending on the conditions, another message may be displayed indicating if the target is moving toward or away from the radar.</p>
<h3>Command-line Options</h3>
<p>There are several command-line options:</p><ul>
<li>-c : execute the radar timing measurement</li>
<li>-o : save the JSON configuration to a file</li>
</ul>
<h3>Demo in Action</h3>
<p>Example output when moving a target between the three zones... </p><pre class="fragment">distance =  0.156, [ 1     ], target moving toward...
distance =  0.131, [ 1     ], target moving toward...
distance =  0.114, [ 1     ], target moving toward...
distance =  0.266, [   2   ]
distance =  0.266, [   2   ]
distance =  0.457, [   2   ], target moving away...
distance =  0.621, [     3 ], target moving away...
distance =  0.689, [     3 ], target moving away...
distance =  0.714, [     3 ], target moving away...
distance =  0.689, [     3 ]
distance =  0.545, [     3 ]
distance =  0.545, [     3 ], target moving toward...
distance =  0.338, [   2   ], target moving toward...
</pre><p>The distance and trending info is shown similar to DopplerTest. The content between the [] represents the zone the target is in.</p>
<p>Example output when no target appears... </p><pre class="fragment">No target...
No target...
No target...
No target...
distance =  0.288, [   2   ], target moving away...
distance =  0.279, [   2   ], target moving away...
distance =  0.304, [   2   ]
</pre><dl class="section user"><dt>Environment</dt><dd>BeagleBone Black + Ancho cape</dd></dl>
<dl class="section user"><dt>Compiler</dt><dd>GNU GCC</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Justin Hadella</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>2015 by FlatEarth, Inc </dd></dl>

<p class="definition">Definition at line <a class="el" href="_ancho_2_zone_sense_doppler_2main_8c_source.html#l00097">97</a> of file <a class="el" href="_ancho_2_zone_sense_doppler_2main_8c_source.html">main.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a3e58dce613fe188fd11fa271fea5c7ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e58dce613fe188fd11fa271fea5c7ac">&#9670;&nbsp;</a></span>DopplerRotate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DopplerRotate </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>dopplerSrc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>dopplerDst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>rowLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>colLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function reorders Doppler matrix so zero velocity is centered</p>
<p>Each Doppler matrix is actually stored as a 1D array. The "columns" store the velocity data. Without modification, the DC or zero-velocity data is in column 0. The next several columns have increasing positive velocities. The remaining half starts with the most negative velocity which increase to 0.</p>
<p>The reordering moves the negative velocity columns to the left, so that each column increases in velocity from the most negative value to the most positive value.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">dopplerSrc</td><td>The Doppler matrix to reorder </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dopplerDst</td><td>The reordered Doppler matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rowLen</td><td>The number of samples in each row </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">colLen</td><td>The number of columns </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_ancho_2_zone_sense_doppler_2main_8c_source.html#l00193">193</a> of file <a class="el" href="_ancho_2_zone_sense_doppler_2main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="a0335d78a0133db828d47d868ea8e5a93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0335d78a0133db828d47d868ea8e5a93">&#9670;&nbsp;</a></span>InterpretZone()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void InterpretZone </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>distance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>velocities</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dopplerLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_ancho_2_zone_sense_doppler_2main_8c_source.html#l00217">217</a> of file <a class="el" href="_ancho_2_zone_sense_doppler_2main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="a3c04138a5bfe5d72780bb7e82a18e627"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c04138a5bfe5d72780bb7e82a18e627">&#9670;&nbsp;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>argv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_ancho_2_zone_sense_doppler_2main_8c_source.html#l00258">258</a> of file <a class="el" href="_ancho_2_zone_sense_doppler_2main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="ae9b526a5bd6a28fbf68db96e8ac72a51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9b526a5bd6a28fbf68db96e8ac72a51">&#9670;&nbsp;</a></span>UpdateVelocity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void UpdateVelocity </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>velocities</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_ancho_2_zone_sense_doppler_2main_8c_source.html#l00210">210</a> of file <a class="el" href="_ancho_2_zone_sense_doppler_2main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="a5ae07f63d6b390e42068d941038dadf2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ae07f63d6b390e42068d941038dadf2">&#9670;&nbsp;</a></span>Usage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Usage </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_ancho_2_zone_sense_doppler_2main_8c_source.html#l00164">164</a> of file <a class="el" href="_ancho_2_zone_sense_doppler_2main_8c_source.html">main.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Feb 6 2019 16:32:47 for Salsa Demo Programs by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
