<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Salsa Demo Programs: Salsa C Demonstration User Guide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Salsa Demo Programs
   &#160;<span id="projectnumber">2016-05-03</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Salsa C Demonstration User Guide </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Salsa software also comes with a variety of application demonstrations. Many of these demo apps build on one another to help you understand how to create your own radar application.</p>
<p>Once you have Salsa installed on your BBB there will be a folder called FlatEarth. Within that folder will be several sub-folders including:</p><ul>
<li>MatlabConnector</li>
<li>Demos</li>
<li>SalsaScope</li>
</ul>
<p>The demonstration applications described in this document will be located in the Demos sub-folder. There is also a sub-folder for each demonstration application. </p><pre class="fragment">Demos/
├── Ancho
├── Cayenne
├── Chipotle
├── Onza
├── Common
├── Desktop_Ancho
└── Desktop_Cayenne
</pre><p>The Ancho, Cayenne, Chipotle and Onza sub-folders contain the demonstration applications which run on the BBB platform; each has the same set of demo apps but are adjusted for the particular radar cape. The Common folder includes common code shared by both the BBB and desktop demos.</p>
<p>The Desktop_Ancho and Desktop_Cayenne folders contain some desktop demonstration apps which communicate with the appropriate version of the BBB RadarServer demo; these desktop demos run on a Linux desktop PC, and utilize the CSFML graphics API.</p>
<p>In order to run the demos, some additional software may need to be installed. Many of the BBB demos use Gnuplot for visualization. Use the links below to quickly jump to the appropriate section.</p>
<ul>
<li><a href="index.html#bbb_gnuplot">Installing Gnuplot on the BBB</a></li>
<li><a href="index.html#bbb_guiconnect">Connecting to BBB using GUI</a></li>
<li><a href="index.html#linux_pc_prep">Installing software for Linux PC Demos</a></li>
<li><a href="index.html#win_pc_prep">Installing software for Windows PC</a></li>
<li><a href="index.html#getting_started">Getting Started with C Development</a></li>
<li><a href="index.html#bbb_demos">BeagleBone Black Demos</a></li>
<li><a href="index.html#linux_pc_demos">Linux PC Demos</a></li>
<li><a href="index.html#configuring_radar">Configuring the Radar</a></li>
</ul>
<h2 id="getting_started">Getting Started with C Development</h2>
<p>There are a number of C demonstration programs written for both the BeagleBone Black (BBB) and Linux PC platforms.</p>
<p>When installed, the C demonstration programs are located on the BBB in the location: </p><pre class="fragment">/root/FlatEarth/Demos
</pre><p>This folder contains a number of sub-folders. Each cape has its <em>own</em> folder. The Ancho and Cayenne folders contain demonstration code which runs on the BBB platform. The Desktop_Ancho and Desktop_Cayenne folders contain demonstration code which runs on a Linux PC. <em>The PC demos work in conjunction with appropriate cape's BBB RadarServer demo app</em>. The Common folder contains some shared code which works on both the BBB and Linux PC platforms.</p>
<hr/>
<p>End products would likely need to run on the embedded platforms, so examining the BBB demos would be a good place to start.</p>
<p>There are a number of demonstration applications which run on the BBB platform. Outside of the RadarServer, many of these demonstrations has the option of using Gnuplot for visualization.</p>
<pre class="fragment">Demos/                      Demos/                      Demos/
└── Ancho                   └── Cayenne                 └── Chipotle 
    ├── ClutterDemo             ├── ClutterDemo             ├── ClutterDemo
    ├── DopplerDemo             ├── DopplerDemo             ├── DopplerDemo 
    ├── FrameLogger             ├── FrameLogger             ├── FrameLogger 
    ├── RadarDemo               ├── RadarDemo               ├── RadarDemo
    ├── RadarServer             ├── RadarServer             ├── RadarServer
    ├── RangingDemo             ├── RangingDemo             ├── RangingDemo
    ├── ZoneSense               ├── ZoneSense               ├── ZoneSense
    └── ZoneSenseDoppler        └── ZoneSenseDoppler        └── ZoneSenseDoppler
    
Demos/
└── Onza
    ├── BasicDemo
    ├── ClutterDemo
    ├── FrameLogger
    ├── FrameStitchDemo
    ├── RadarServer
    ├── DDC Ranging Demo
    ├── Ranging Demo
    └── Doppler Demo
</pre><p>To run and or edit a demonstration application, open a terminal, navigate into each demo folder and then type 'make' to build it.</p>
<p>The "hello world" for radar cape development starts with RadarDemo at the lowest level of complexity. This demo is further enhanced in several iterations in the following progression: </p><pre class="fragment">RadarDemo
  └─ClutterDemo
     └─RangingDemo
         └─ZoneSense
</pre><p>This set of demos is intended to show how to build up complexity when writing code for the radar capes in the C language. These demos are all similar as they process individual radar frames without history; in other words, a radar frame is captured, processed, then the loop repeats. These demos are mostly useful for viewing data in a similar fashion as SalsaScope, but here the code is available for inspection.</p>
<p>The DopplerDemo project uses the pulse Doppler processing technique. Instead of processing individual radar frames as they arrive, in this technique, a limited history of past frames is also used. Doppler is particularly useful to detect targets in motion. In addition to distance estimation, Doppler is also useful to discover direction of travel. The ZoneSenseDoppler project builds upon the DopplerDemo project, but adds in some additional complexity.</p>
<p>Often, it is difficult to obtain realistic radar data at a developer's desk. The FrameLogger demo folder contains two programs, the FrameLogger itself, and the corresponding FrameViewer. These programs serve as basic examples on how a data logging program could work. The FrameLogger program captures radar frames and saves them to a binary file. The FrameViewer program reads these files back and can display the data via Gnuplot. However, FrameViewer is <em>more</em> useful as a template for a radar data post-processing application.</p>
<p>The RadarServer demo is an example of a TCP server. It is used to generate data for the Linux desktop PC demo apps. The set of Linux desktop apps use the CSFML graphics API for radar signal visualization. To make a new demo, the user would make a clone of one of the existing desktop demos, then implement the functions declared that folder's radarClient.h header.</p>
<hr/>
<h3 id="bbb_demos">BeagleBone Black Demos</h3>
<p>There are a number of demonstration programs which run on the BeagleBone Black (BBB) hardware platform. There is code for both the Ancho and Cayenne radar capes. The demonstration code is nearly the same for each, but some aspects are tuned for the particular cape.</p>
<p>Click the links below to go to the documentation page for each demonstration.</p>
<h4>Ancho</h4>
<div class="multicol">
<ul>
<li><a href="_ancho_2_radar_demo_2main_8c.html#bbb_ancho_radar_demo">Basic Radar Demo</a></li>
<li><a href="_ancho_2_clutter_demo_2main_8c.html#bbb_ancho_clutter_demo">Clutter Demo</a></li>
<li><a href="_ancho_2_ranging_demo_2main_8c.html#bbb_ancho_ranging_demo">Ranging Demo</a></li>
<li><a href="_ancho_2_zone_sense_2main_8c.html#bbb_ancho_zonesense_demo">Zone-Sense Demo</a></li>
<li><a href="_ancho_2_doppler_demo_2main_8c.html#bbb_ancho_doppler_demo">Doppler Demo</a></li>
<li><a href="_ancho_2_zone_sense_doppler_2main_8c.html#bbb_ancho_zonesense_doppler_demo">Zone-Sense Doppler Demo</a></li>
<li><a href="_ancho_2_frame_logger_2frame_logger_8c.html#bbb_ancho_framelogger_demo">Frame Logger Demo</a></li>
<li><a href="_ancho_2_frame_logger_2frame_viewer_8c.html#bbb_ancho_frameviewer_demo">Frame Log Viewer Demo</a></li>
<li><a href="_ancho_2_radar_server_2radar_server_8c.html#bbb_ancho_radarserver_demo">Radar Server Demo</a></li>
</ul>
</div>
<h4>Cayenne</h4>
<div class="multicol">
<ul>
<li><a href="_cayenne_2_radar_demo_2main_8c.html#bbb_cayenne_radar_demo">Basic Radar Demo</a></li>
<li><a href="_cayenne_2_clutter_demo_2main_8c.html#bbb_cayenne_clutter_demo">Clutter Demo</a></li>
<li><a href="_cayenne_2_ranging_demo_2main_8c.html#bbb_cayenne_ranging_demo">Ranging Demo</a></li>
<li><a href="_cayenne_2_zone_sense_2main_8c.html#bbb_cayenne_zonesense_demo">Zone-Sense Demo</a></li>
<li><a href="_cayenne_2_doppler_demo_2main_8c.html#bbb_cayenne_doppler_demo">Doppler Demo</a></li>
<li><a href="_cayenne_2_zone_sense_doppler_2main_8c.html#bbb_cayenne_zonesense_doppler_demo">Zone-Sense Doppler Demo</a></li>
<li><a href="_cayenne_2_frame_logger_2frame_logger_8c.html#bbb_cayenne_framelogger_demo">Frame Logger Demo</a></li>
<li><a href="_cayenne_2_frame_logger_2frame_viewer_8c.html#bbb_cayenne_frameviewer_demo">Frame Log Viewer Demo</a></li>
<li><a href="_cayenne_2_radar_server_2radar_server_8c.html#bbb_cayenne_radarserver_demo">Radar Server Demo</a></li>
</ul>
</div>
<h4>Chipotle</h4>
<div class="multicol">
<ul>
<li><a href="radar_demo_8c.html#bbb_chipotle_radar_demo">Basic Radar Demo</a></li>
<li><a href="_chipotle_2_clutter_demo_2clutter_demo_8c.html#bbb_chipotle_clutter_demo">Clutter Demo</a></li>
<li><a href="ranging_demo_8c.html#bbb_chipotle_ranging_demo">Ranging Demo</a></li>
<li><a href="zone_sense_8c.html#bbb_chipotle_zonesense_demo">Zone-Sense Demo</a></li>
<li><a href="doppler_demo_8c.html#bbb_chipotle_doppler_demo">Doppler Demo</a></li>
<li><a href="zone_doppler_8c.html#bbb_chipotle_zonesense_doppler_demo">Zone-Sense Doppler Demo</a></li>
<li><a href="_chipotle_2_frame_logger_2frame_logger_8c.html#bbb_chipotle_framelogger_demo">Frame Logger Demo</a></li>
<li><a href="_chipotle_2_frame_logger_2frame_viewer_8c.html#bbb_chipotle_frameviewer_demo">Frame Log Viewer Demo</a></li>
<li><a href="_chipotle_2_radar_server_2radar_server_8c.html#bbb_chipotle_radarserver_demo">Radar Server Demo</a></li>
</ul>
</div>
<h4>Onza</h4>
<div class="multicol">
<ul>
<li><a href="_onza_2_basic_demo_2demo_8c.html#bbb_onza_basic_demo">Basic Radar Demo</a></li>
<li><a href="_onza_2_clutter_demo_2clutter_demo_8c.html#bbb_onza_clutter_demo">Clutter Demo</a></li>
<li><a href="_onza_2_frame_logger_2frame_logger_8c.html#bbb_onza_framelogger_demo">Frame Logger Demo</a></li>
<li><a href="_onza_2_frame_logger_2frame_viewer_8c.html#bbb_onza_frameviewer_demo">Frame Log Viewer Demo</a></li>
<li><a href="_onza_2_frame_stitch_demo_2demo_8c.html#bbb_onza_framestitch_demo">Frame Stitch Demo</a></li>
<li><a href="_onza_2_radar_server_2radar_server_8c.html#bbb_onza_radarserver_demo">Radar Server Demo</a></li>
<li><a href="ddc__ranging__demo_8c.html#bbb_onza_ddc_ranging_demo">DDC Ranging Demo</a></li>
<li><a href="ranging__demo_8c.html#bbb_onza_ranging_demo">Ranging Demo</a></li>
<li><a href="doppler__demo_8c.html#bbb_onza_doppler_demo">Doppler Demo</a></li>
</ul>
</div>
<hr/>
<h3 id="linux_pc_demos">Linux PC Demos</h3>
<p>The Desktop_Ancho and Desktop_Cayenne folders contain demonstration applications which run on a Linux desktop PC and communicate with the appropriate <em>RadarServer</em> demonstration app. The server has identical functionality for each cape. The desktop demos are nearly the same for each cape, but there are some small differences, so use the appropriate cape's desktop demo.</p>
<pre class="fragment">Demos/                      Demos/
└── Desktop_Ancho           └── Desktop_Cayenne
    ├── ClutterDemo             ├── ClutterDemo
    ├── DopplerDemo             ├── DopplerDemo
    ├── MotionDetectDemo        ├── MotionDetectDemo
    ├── RadarClient             ├── RadarClient
    └── RangingDemo             └── RangingDemo
</pre><p>The <em>RadarClient</em> sub-folder contains shared code that each of the demonstration apps use. This code understands the protocol used by the <em>RadarServer</em>. The radarClient.h header declares several functions. Each of these demonstration apps then implements these functions in different ways depending on the visualization and DSP.</p>
<p>The other sub-folders contain the desktop demonstrations. With these demo apps, all the DSP and viewing is handled by the local Linux PC.</p>
<dl class="section note"><dt>Note</dt><dd>If VirtualBox is used to host the Linux desktop, there is possible issue with the version of OpenGL it uses. In order for the desktop demos to work, 3D acceleration should be disabled.</dd></dl>
<p>Click the links below to go to the documentation page for each demonstration.</p>
<h4>Ancho</h4>
<div class="multicol">
<ul>
<li><a href="_desktop___ancho_2_clutter_demo_2demo_8c.html#desktop_ancho_clutter_demo">Clutter Demo</a></li>
<li><a href="_desktop___ancho_2_doppler_demo_2demo_8c.html#desktop_ancho_doppler_demo">Doppler Demo</a></li>
<li><a href="_desktop___ancho_2_motion_detect_demo_2motion_detect_8c.html#desktop_ancho_motion_demo">Motion Detection Demo</a></li>
<li><a href="_desktop___ancho_2_ranging_demo_2demo_8c.html#desktop_ancho_ranging_demo">Ranging Demo</a></li>
</ul>
</div>
<h4>Cayenne</h4>
<div class="multicol">
<ul>
<li><a href="_desktop___cayenne_2_clutter_demo_2demo_8c.html#desktop_cayenne_clutter_demo">Clutter Demo</a></li>
<li><a href="_desktop___cayenne_2_doppler_demo_2demo_8c.html#desktop_cayenne_doppler_demo">Doppler Demo</a></li>
<li><a href="_desktop___cayenne_2_motion_detect_demo_2motion_detect_8c.html#desktop_cayenne_motion_demo">Motion Detection Demo</a></li>
<li><a href="_desktop___cayenne_2_ranging_demo_2demo_8c.html#desktop_cayenne_ranging_demo">Ranging Demo</a></li>
</ul>
</div>
<dl class="section note"><dt>Note</dt><dd>The hardware used in the Cayenne and Chipotle is similar; both use the same X1 radar IC. The Desktop_Cayenne PC demos will run without modification with the Chipotle version of the <em>Radar Server</em> demo.</dd></dl>
<h4>Example</h4>
<p>For this example, an Ancho cape is used. The desktop demo apps require that the radar server app on the BBB is active. Open a terminal to the BBB and then start the radar server. </p><pre class="fragment">user@LinuxPC: $ ssh root@192.168.7.2
root@beaglebone:~# cd FlatEarth/Demos/Ancho/RadarServer/
root@beaglebone:~/FlatEarth/Demos/Ancho/RadarServer# make
root@beaglebone:~/FlatEarth/Demos/Ancho/RadarServer# ./radarServer 11111
Calibrating radar (may take several seconds)
Server ready...
</pre><p>On the Linux PC, navigate to the location where the Desktop_Ancho folder was copied to. This folder contains several sub-folders. The actual demonstration apps all end with the suffix "Demo". The RadarClient folder contains shared code that each demo uses to communicate with the server.</p>
<p>Using the terminal, navigate into one of the demonstration folders and type 'make' to build that demo. For example, to build then run the ClutterDemo: </p><pre class="fragment">user@LinuxPC:~/Demos/Desktop_Ancho$ cd ClutterDemo/
user@LinuxPC:~/Demos/Desktop_Ancho/ClutterDemo$ make
user@LinuxPC:~/Demos/Desktop_Ancho/ClutterDemo$ ./clutterDemo 192.168.7.2 11111
</pre><hr/>
<h2 id="bbb_gnuplot">Installing Gnuplot on the BBB</h2>
<p>Many of the demo applications use Gnuplot. In order to see the plots, the user must enable X11 forwarding (the -X option). </p><pre class="fragment">$ ssh -X root@192.168.7.2
</pre><p>In case you need to install the gnuplot x11 plotting engine:</p><ol type="1">
<li>Connect Ethernet cable, with internet access, to BBB.</li>
<li>Restart BBB with 'reboot' command or unplug/plug USB cable(This enables BBB to get IP address through your network DHCP).</li>
<li>Type -&gt; apt-get update</li>
<li>Type -&gt; apt-get install gnuplot-x11</li>
</ol>
<hr/>
<h2 id="bbb_guiconnect">Connecting to BBB using GUI</h2>
<p>Some users may prefer to interact with the BBB using the Ubuntu GUI rather than by the command-line. In Ubuntu, click on the icon which resembles a file cabinet to open up the File Explorer. Then, click on the 'Connect to Server' option under the Network category in the left-side column. This brings up a dialog box.</p>
<div class="image">
<img src="connect_to_server.png" alt="connect_to_server.png"/>
<div class="caption">
Connect to Server</div></div>
<p>Under the 'Server Address' add the line (assuming USB connection): </p><pre class="fragment">sftp://192.168.7.2/root
</pre><p>This should open a login dialog box. For the user name, enter 'root' and leave the password field blank. Click 'Connect'.</p>
<div class="image">
<img src="login.png" alt="login.png"/>
<div class="caption">
Login Dialog</div></div>
<p>If this is the first time this BBB has been connected to from the PC, it may show a warning. Click the 'Log In Anyway' option.</p>
<div class="image">
<img src="verify_connect.png" alt="verify_connect.png"/>
<div class="caption">
SSH Warning</div></div>
<hr/>
<h2 id="linux_pc_prep">Installing software for Linux PC Demos</h2>
<p>In order to use the Linux desktop demo apps, a number of steps are required in advance. The first thing to do is determine the appropriate version of the Debian packages to install. Open a terminal on the Linux desktop, and enter: </p><pre class="fragment">$ arch
</pre><p>A 32-bit Linux installation will respond with i686. A 64-bit Linux installation will respond with x86_64. The two Debian packages are named using the format: </p><pre class="fragment">salsalib_&lt;date&gt;_&lt;arch&gt;.deb
salsalib-dev_&lt;date&gt;_&lt;arch&gt;.deb

where...

&lt;arch&gt; is i386 for 32-bit Linux PC
&lt;arch&gt; is amd64 for 64-bit Linux PC
</pre><p>Copy the appropriate .deb files to the Linux PC; they are located in the "Installers\LinuxInstallers\PC" folder in the included USB stick.</p>
<p>The Debian packages can then be installed using the command-line: </p><pre class="fragment">sudo dpkg -i [filename]
</pre><p>They can also be installed just by double-clicking the file's icon and then clicking the 'install' button in the package manager window which opens. <em>If the same Debian package has already been installed, the button will display as 'reinstall' instead</em>.</p>
<p>The Linux desktop demonstrations use the SFML graphics API for visualization. SFML is a lightweight, multi-platform, multi-language API.</p>
<p>To install 'C' version of SFML on an Ubuntu system: </p><pre class="fragment">sudo apt-get update
sudo apt-get install libcsfml-dev
</pre><p>Next, copy the Demos/Common folder and then either the Demos/Desktop_Ancho or Demos/Desktop_Cayenne folders to a location on the Linux desktop.</p>
<hr/>
<h2 id="win_pc_prep">Installing software for Windows PC</h2>
<p>In order to use Windows along with the BBB demonstration software, the Windows PC requires some additional software.</p>
<p>For SSH, we use the PuTTY on a Windows system. It can be downloaded from the url: <a href="http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html">http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html</a> and is also located on the Salsa thumb drive in the Utilities folder.</p>
<p>You also need an X-Windows server for Windows. One such example is the Xming X Server. It can be downloaded from the url: <a href="http://sourceforge.net/projects/xming/">http://sourceforge.net/projects/xming/</a>. This is also located on the Salsa Thumb drive in the Utilities folder.</p>
<h3>Instructions for installing Xming</h3>
<div class="image">
<img src="xming_1.png" alt="xming_1.png"/>
</div>
 <div class="image">
<img src="xming_2.png" alt="xming_2.png"/>
</div>
 <p>Make sure to select the option to not install SSH client.</p>
<div class="image">
<img src="xming_3.png" alt="xming_3.png"/>
</div>
 <div class="image">
<img src="xming_4.png" alt="xming_4.png"/>
</div>
 <div class="image">
<img src="xming_5.png" alt="xming_5.png"/>
</div>
 <div class="image">
<img src="xming_6.png" alt="xming_6.png"/>
</div>
 <div class="image">
<img src="xming_7.png" alt="xming_7.png"/>
</div>
 <div class="image">
<img src="xming_8.png" alt="xming_8.png"/>
</div>
 <p>Run the Xming application. The first time the application is launched, a firewall warning may appear. Please select the 'Allow access' option if prompted. Make sure to start Xming in advance before running any of the BBB demos which use Gnuplot.</p>
<h3>Instructions for installing PuTTY</h3>
<p>Next, we'll setup PuTTY, which serves as out SSH client into the BeagleBone.</p>
<p>Start PuTTY. On the initial 'Session' screen, the BeagleBone Black's IP address is 192.168.7.2 (for the USB connection).</p>
<p>Next. Expand the SSH menu, and select the X11 option. Click the 'Enable X11 forwarding' option and make sure it's checked.</p>
<div class="image">
<img src="putty_1.png" alt="putty_1.png"/>
</div>
 <div class="image">
<img src="putty_2.png" alt="putty_2.png"/>
</div>
 <p>Next, click the 'Data' selection. Enter 'root' as the username. Finally, click 'Session' again, and this time name the session and click the Save button (so you won't have to do this all over again!). Click 'Open'.</p>
<div class="image">
<img src="putty_3.png" alt="putty_3.png"/>
</div>
 <div class="image">
<img src="putty_4.png" alt="putty_4.png"/>
</div>
 <div class="image">
<img src="putty_5.png" alt="putty_5.png"/>
</div>
 <hr/>
<h2 id="configuring_radar">Configuring the Radar</h2>
<p>The Radarlib3 API provides mechanisms to control the radar IC by updating variables, reading variables, performing actions, etc.</p>
<p>For example, to set the <em>FrameStitch</em> variable to 2 the code would look like: </p><div class="fragment"><div class="line">radarStatus = NVA_VarSetIntValue_ByName(radarHandle, &quot;FrameStitch&quot;, 2);</div><div class="line">if (radarStatus != NVA_SUCCESS)</div><div class="line">{</div><div class="line">  NVA_GetErrorDescription(radarHandle, radarErrorMsg, sizeof(radarErrorMsg), radarHandle-&gt;errorHandle-&gt;lastError);</div><div class="line">  fprintf(stderr, &quot;%s\n&quot;, radarErrorMsg);</div><div class="line">  return (1);</div><div class="line">}</div></div><!-- fragment --><p>Radarlib3 variables are of type Value_t which is a <em>Union</em> composed of an int and float. <em>There is also a more generic call, NVA_VarSetValue_ByName(), but it takes Value_t arguments. Using it is more complicated</em>.</p>
<p>In general, most apps will require some customization of the Radarlib3 variables. This same code block could be repeated for each integer type variable; there is a similar function to set float variables.</p>
<p>The Salsa radar helper API provides a mechanism configure the radar using JSON files making the code much shorter. Each BeagleBone Black demonstration contains two files, "stage1.json" and "stage2.json".</p>
<p>In the JSON files, each setting is represented as a { "key" : value } pair. The "key" is the string which represents the name of a Radarlib3 variable, and the value is a number. The API will read the number as an <em>int</em> or <em>float</em> depending on the variable name. If the value is "null" then that variable is treated as a "read-only" value.</p>
<p>The JSON configuration files are loaded in two stages. <em>There are a number of Radarlib3 variables which only work after a timing measurement has been made</em>. The example JSON files are organized to demonstrate this.</p>
<h3>stage1.json:</h3>
<pre class="fragment">[
  {"DACMin" : 1000},
  {"DACMax" : 7000},
  {"DACStep" : 32},
  {"Iterations" : 200},
  {"PulsesPerStep" : 16},
  {"FrameStitch" : 1}
]
</pre><p>The first five settings in stage1.json effect the sampling circuitry. These will typically be modified for specific applications. These are the primary variables which effect the radar frame rate and signal to noise ratio.</p>
<p>The next setting, 'FrameStitch' determines how many individual radar frames are concatenated or "stitched" together. Since the frames are independent, using this feature will reduce the overall framerate when the value is &gt; 1.</p>
<dl class="section note"><dt>Note</dt><dd>On the Ancho (XeThru X2) each individual radar frame is composed of 256 samples (or bins) spanning a distance of ~ 1 m. The Cayenne (XeThru X1) frame 512 samples spanning ~ 2 m. The <em>FrameStitch</em> value can be used to increase the overall frame span at the expense of measurement time.</dd></dl>
<p>In practical applications, the timing measurements should <em>always</em> be executed after the stage1 configuration. The stage2 configuration includes some additional parameters which should be set only after the timing measurement.</p>
<h3>stage2.json:</h3>
<pre class="fragment">[
  {"OffsetDistanceFromReference" : 0.1},
  {"SampleDelayToReference" : 3.867e-9},
  {"SamplesPerSecond" : null},
  {"SamplersPerFrame" : null},
  {"SampleDelay" : null}
]
</pre><p>'OffsetDistanceFromReference' controls the distance (in meters) at which to start sampling the radar from. Typically, the reference point is something tangible like the surface of an antenna radome.</p>
<dl class="section note"><dt>Note</dt><dd><em>OffsetDistanceFromReference</em> and <em>FrameStitch</em> can be used in combination. For example, let's suppose we were interested in detecting targets between 2.0-2.5 m. We could set just set <em>OffsetDistanceFromReference</em> to 0.0 and "FrameStitch" to 3, but then much of the signal wouldn't be of any interest. In might be better in this case to set <em>OffsetDistanceFromReference</em> to 1.75 and <em>FrameStitch</em> to 1. <em>These settings should always allow some headroom in either direction since the radar pulse itself spans a number of samples</em>.</dd></dl>
<p>'SampleDelayToReference' is a delay (in nanoseconds) which is used to adjust error in distance computations. There will be inherent delay due to internal circuitry. There is also additional delay due to antenna cabling. This value was determined empirically for the <em>Ancho</em> cape, the antennas, and the 3" SMA antenna cables. This value is different for the <em>Cayenne</em> cape.</p>
<p>The final three settings have a value "null." This indicates that if we want to save the running JSON configuration, we are <em>interested</em> in these values, but are interpreted as read-only.</p>
<p>Each of the BBB demo apps will include both stage1.json and stage2.json files. However, some of the settings shown above may differ, and there also may be additional settings. <em>Keep in mind that these files are simply a convenience to avoid repeated replication of the code block shown at the beginning of this section</em>. The "key" must be a string which represents a Radarlib3 variable. The X1 and X2 share many variable names in common, but each also has its own unique variables as well. See the Radarlib3 documentation. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Feb 6 2019 16:32:47 for Salsa Demo Programs by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
